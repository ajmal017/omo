+function(d){var c=window.navigator.appName=="Microsoft Internet Explorer";var a=function(g,f){this.$element=d(g);this.$input=this.$element.find(":file");if(this.$input.length===0){return}this.name=this.$input.attr("name")||f.name;this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]');if(this.$hidden.length===0){this.$hidden=d('<input type="hidden">').insertBefore(this.$input)}this.$preview=this.$element.find(".fileinput-preview");var e=this.$preview.css("height");if(this.$preview.css("display")!=="inline"&&e!=="0px"&&e!=="none"){this.$preview.css("line-height",e)}this.original={exists:this.$element.hasClass("fileinput-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()};this.listen()};a.prototype.listen=function(){this.$input.on("change.bs.fileinput",d.proxy(this.change,this));d(this.$input[0].form).on("reset.bs.fileinput",d.proxy(this.reset,this));this.$element.find('[data-trigger="fileinput"]').on("click.bs.fileinput",d.proxy(this.trigger,this));this.$element.find('[data-dismiss="fileinput"]').on("click.bs.fileinput",d.proxy(this.clear,this))},a.prototype.change=function(l){var j=l.target.files===undefined?(l.target&&l.target.value?[{name:l.target.value.replace(/^.+\\/,"")}]:[]):l.target.files;l.stopPropagation();if(j.length===0){this.clear();return}this.$hidden.val("");this.$hidden.attr("name","");this.$input.attr("name",this.name);var h=j[0];if(this.$preview.length>0&&(typeof h.type!=="undefined"?h.type.match(/^image\/(gif|png|jpeg)$/):h.name.match(/\.(gif|png|jpe?g)$/i))&&typeof FileReader!=="undefined"){var f=new FileReader();var k=this.$preview;var g=this.$element;f.onload=function(m){var e=d("<img>");e[0].src=m.target.result;j[0].result=m.target.result;g.find(".fileinput-filename").text(h.name);if(k.css("max-height")!="none"){e.css("max-height",parseInt(k.css("max-height"),10)-parseInt(k.css("padding-top"),10)-parseInt(k.css("padding-bottom"),10)-parseInt(k.css("border-top"),10)-parseInt(k.css("border-bottom"),10))}k.html(e);g.addClass("fileinput-exists").removeClass("fileinput-new");g.trigger("change.bs.fileinput",j)};f.readAsDataURL(h)}else{this.$element.find(".fileinput-filename").text(h.name);this.$preview.text(h.name);this.$element.addClass("fileinput-exists").removeClass("fileinput-new");this.$element.trigger("change.bs.fileinput")}},a.prototype.clear=function(g){if(g){g.preventDefault()}this.$hidden.val("");this.$hidden.attr("name",this.name);this.$input.attr("name","");if(c){var f=this.$input.clone(true);this.$input.after(f);this.$input.remove();this.$input=f}else{this.$input.val("")}this.$preview.html("");this.$element.find(".fileinput-filename").text("");this.$element.addClass("fileinput-new").removeClass("fileinput-exists");if(g!==undefined){this.$input.trigger("change");this.$element.trigger("clear.bs.fileinput")}},a.prototype.reset=function(){this.clear();this.$hidden.val(this.original.hiddenVal);this.$preview.html(this.original.preview);this.$element.find(".fileinput-filename").text("");if(this.original.exists){this.$element.addClass("fileinput-exists").removeClass("fileinput-new")}else{this.$element.addClass("fileinput-new").removeClass("fileinput-exists")}this.$element.trigger("reset.bs.fileinput")},a.prototype.trigger=function(f){this.$input.trigger("click");f.preventDefault()};var b=d.fn.fileinput;d.fn.fileinput=function(e){return this.each(function(){var g=d(this),f=g.data("bs.fileinput");if(!f){g.data("bs.fileinput",(f=new a(this,e)))}if(typeof e=="string"){f[e]()}})};d.fn.fileinput.Constructor=a;d.fn.fileinput.noConflict=function(){d.fn.fileinput=b;return this};d(document).on("click.fileinput.data-api",'[data-provides="fileinput"]',function(h){var g=d(this);if(g.data("bs.fileinput")){return}g.fileinput(g.data());var f=d(h.target).closest('[data-dismiss="fileinput"],[data-trigger="fileinput"]');if(f.length>0){h.preventDefault();f.trigger("click.bs.fileinput")}})}(window.jQuery);!function(c){var a=function(f,e){this.init(f,e)};a.prototype={constructor:a,init:function(f,e){this.$element=c(f);this.options=c.extend({},c.fn.modalmanager.defaults,this.$element.data(),typeof e=="object"&&e);this.stack=[];this.backdropCount=0;if(this.options.resize){var h,g=this;c(window).on("resize.modal",function(){h&&clearTimeout(h);h=setTimeout(function(){for(var j=0;j<g.stack.length;j++){g.stack[j].isShown&&g.stack[j].layout()}},10)})}},createModal:function(f,e){c(f).modal(c.extend({manager:this},e))},appendModal:function(f){this.stack.push(f);var e=this;f.$element.on("show.modalmanager",b(function(h){var g=function(){f.isShown=true;var j=c.support.transition&&f.$element.hasClass("fade");e.$element.toggleClass("modal-open",e.hasOpenModal()).toggleClass("page-overflow",c(window).height()<e.$element.height());f.$parent=f.$element.parent();f.$container=e.createContainer(f);f.$element.appendTo(f.$container);e.backdrop(f,function(){f.$element.show();if(j){f.$element[0].offsetWidth}f.layout();f.$element.addClass("in").attr("aria-hidden",false);var k=function(){e.setFocus();f.$element.trigger("shown")};j?f.$element.one(c.support.transition.end,k):k()})};f.options.replace?e.replace(g):g()}));f.$element.on("hidden.modalmanager",b(function(g){e.backdrop(f);if(!f.$element.parent().length){e.destroyModal(f)}else{if(f.$backdrop){var h=c.support.transition&&f.$element.hasClass("fade");if(h){f.$element[0].offsetWidth}c.support.transition&&f.$element.hasClass("fade")?f.$backdrop.one(c.support.transition.end,function(){f.destroy()}):f.destroy()}else{f.destroy()}}}));f.$element.on("destroyed.modalmanager",b(function(g){e.destroyModal(f)}))},getOpenModals:function(){var f=[];for(var e=0;e<this.stack.length;e++){if(this.stack[e].isShown){f.push(this.stack[e])}}return f},hasOpenModal:function(){return this.getOpenModals().length>0},setFocus:function(){var f;for(var e=0;e<this.stack.length;e++){if(this.stack[e].isShown){f=this.stack[e]}}if(!f){return}f.focus()},destroyModal:function(f){f.$element.off(".modalmanager");if(f.$backdrop){this.removeBackdrop(f)}this.stack.splice(this.getIndexOfModal(f),1);var e=this.hasOpenModal();this.$element.toggleClass("modal-open",e);if(!e){this.$element.removeClass("page-overflow")}this.removeContainer(f);this.setFocus()},getModalAt:function(e){return this.stack[e]},getIndexOfModal:function(f){for(var e=0;e<this.stack.length;e++){if(f===this.stack[e]){return e}}},replace:function(g){var f;for(var e=0;e<this.stack.length;e++){if(this.stack[e].isShown){f=this.stack[e]}}if(f){this.$backdropHandle=f.$backdrop;f.$backdrop=null;g&&f.$element.one("hidden",b(c.proxy(g,this)));f.hide()}else{if(g){g()}}},removeBackdrop:function(e){e.$backdrop.remove();e.$backdrop=null},createBackdrop:function(g,f){var e;if(!this.$backdropHandle){e=c(f).addClass(g).appendTo(this.$element)}else{e=this.$backdropHandle;e.off(".modalmanager");this.$backdropHandle=null;this.isLoading&&this.removeSpinner()}return e},removeContainer:function(e){e.$container.remove();e.$container=null},createContainer:function(e){var f;f=c('<div class="modal-scrollable">').css("z-index",d("modal",this.getOpenModals().length)).appendTo(this.$element);if(e&&e.options.backdrop!="static"){f.on("click.modal",b(function(g){e.hide()}))}else{if(e){f.on("click.modal",b(function(g){e.attention()}))}}return f},backdrop:function(h,k){var f=h.$element.hasClass("fade")?"fade":"",j=h.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(h.isShown&&j){var e=c.support.transition&&f&&!this.$backdropHandle;h.$backdrop=this.createBackdrop(f,h.options.backdropTemplate);h.$backdrop.css("z-index",d("backdrop",this.getOpenModals().length));if(e){h.$backdrop[0].offsetWidth}h.$backdrop.addClass("in");this.backdropCount+=1;e?h.$backdrop.one(c.support.transition.end,k):k()}else{if(!h.isShown&&h.$backdrop){h.$backdrop.removeClass("in");this.backdropCount-=1;var g=this;c.support.transition&&h.$element.hasClass("fade")?h.$backdrop.one(c.support.transition.end,function(){g.removeBackdrop(h)}):g.removeBackdrop(h)}else{if(k){k()}}}},removeSpinner:function(){this.$spinner&&this.$spinner.remove();this.$spinner=null;this.isLoading=false},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(h){h=h||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",c(window).height()<this.$element.height());if(!this.isLoading){this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate);this.$backdropHandle[0].offsetWidth;var e=this.getOpenModals();this.$backdropHandle.css("z-index",d("backdrop",e.length+1)).addClass("in");var g=c(this.options.spinner).css("z-index",d("modal",e.length+1)).appendTo(this.$element).addClass("in");this.$spinner=c(this.createContainer()).append(g).on("click.modalmanager",c.proxy(this.loading,this));this.isLoading=true;c.support.transition?this.$backdropHandle.one(c.support.transition.end,h):h()}else{if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var f=this;c.support.transition?this.$backdropHandle.one(c.support.transition.end,function(){f.removeLoading()}):f.removeLoading()}else{if(h){h(this.isLoading)}}}}};var d=(function(){var f,e={};return function(g,k){if(typeof f==="undefined"){var j=c('<div class="modal hide" />').appendTo("body"),h=c('<div class="modal-backdrop hide" />').appendTo("body");e.modal=+j.css("z-index");e.backdrop=+h.css("z-index");f=e.modal-e.backdrop;j.remove();h.remove();h=j=null}return e[g]+(f*k)}}());function b(e){return function(f){if(f&&this===f.target){return e.apply(this,arguments)}}}c.fn.modalmanager=function(f,e){return this.each(function(){var h=c(this),g=h.data("modalmanager");if(!g){h.data("modalmanager",(g=new a(this,f)))}if(typeof f==="string"){g[f].apply(g,[].concat(e))}})};c.fn.modalmanager.defaults={backdropLimit:999,resize:true,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};c.fn.modalmanager.Constructor=a;c(function(){c(document).off("show.bs.modal").off("hidden.bs.modal")})}(jQuery);!function(b){var a=function(d,c){this.init(d,c)};a.prototype={constructor:a,init:function(e,c){var f=this;this.options=c;this.$element=b(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote,function(){var g=b.Event("loaded");f.$element.trigger(g)});var d=typeof this.options.manager==="function"?this.options.manager.call(this):this.options.manager;d=d.appendModal?d:b(d).modalmanager().data("modalmanager");d.appendModal(this)},toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var c=b.Event("show");if(this.isShown){return}this.$element.trigger(c);if(c.isDefaultPrevented()){return}this.escape();this.tab();this.options.loading&&this.loading()},hide:function(c){c&&c.preventDefault();c=b.Event("hide");this.$element.trigger(c);if(!this.isShown||c.isDefaultPrevented()){return}this.isShown=false;this.escape();this.tab();this.isLoading&&this.loading();b(document).off("focusin.modal");this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",true);b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},layout:function(){var f=this.options.height?"height":"max-height",d=this.options.height||this.options.maxHeight;if(this.options.width){this.$element.css("width",this.options.width);var c=this;this.$element.css("margin-left",function(){if(/%/ig.test(c.options.width)){return -(parseInt(c.options.width)/2)+"%"}else{return -(b(this).width()/2)+"px"}})}else{this.$element.css("width","");this.$element.css("margin-left","")}this.$element.find(".modal-body").css("overflow","").css(f,"");if(d){this.$element.find(".modal-body").css("overflow","auto").css(f,d)}var e=b(window).height()-10<this.$element.height();if(e||this.options.modalOverflow){this.$element.css("margin-top",0).addClass("modal-overflow")}else{this.$element.css("margin-top",0-this.$element.height()/2).removeClass("modal-overflow")}},tab:function(){var c=this;if(this.isShown&&this.options.consumeTab){this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(g){if(g.keyCode&&g.keyCode==9){var d=b(this),f=b(this);c.$element.find("[data-tabindex]:enabled:not([readonly])").each(function(h){if(!h.shiftKey){d=d.data("tabindex")<b(this).data("tabindex")?d=b(this):f=b(this)}else{d=d.data("tabindex")>b(this).data("tabindex")?d=b(this):f=b(this)}});d[0]!==b(this)[0]?d.focus():f.focus();g.preventDefault()}})}else{if(!this.isShown){this.$element.off("keydown.tabindex.modal")}}},escape:function(){var c=this;if(this.isShown&&this.options.keyboard){if(!this.$element.attr("tabindex")){this.$element.attr("tabindex",-1)}this.$element.on("keyup.dismiss.modal",function(d){d.which==27&&c.hide()})}else{if(!this.isShown){this.$element.off("keyup.dismiss.modal")}}},hideWithTransition:function(){var c=this,d=setTimeout(function(){c.$element.off(b.support.transition.end);c.hideModal()},500);this.$element.one(b.support.transition.end,function(){clearTimeout(d);c.hideModal()})},hideModal:function(){var d=this.options.height?"height":"max-height";var c=this.options.height||this.options.maxHeight;if(c){this.$element.find(".modal-body").css("overflow","").css(d,"")}this.$element.hide().trigger("hidden")},removeLoading:function(){this.$loading.remove();this.$loading=null;this.isLoading=false},loading:function(f){f=f||function(){};var d=this.$element.hasClass("fade")?"fade":"";if(!this.isLoading){var c=b.support.transition&&d;this.$loading=b('<div class="loading-mask '+d+'">').append(this.options.spinner).appendTo(this.$element);if(c){this.$loading[0].offsetWidth}this.$loading.addClass("in");this.isLoading=true;c?this.$loading.one(b.support.transition.end,f):f()}else{if(this.isLoading&&this.$loading){this.$loading.removeClass("in");var e=this;b.support.transition&&this.$element.hasClass("fade")?this.$loading.one(b.support.transition.end,function(){e.removeLoading()}):e.removeLoading()}else{if(f){f(this.isLoading)}}}},focus:function(){var c=this.$element.find(this.options.focusOn);c=c.length?c:this.$element;c.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var c=this;setTimeout(function(){c.$element.addClass("animated").addClass(c.options.attentionAnimation)},0)}this.focus()},destroy:function(){var c=b.Event("destroy");this.$element.trigger(c);if(c.isDefaultPrevented()){return}this.$element.off(".modal").removeData("modal").removeClass("in").attr("aria-hidden",true);if(this.$parent!==this.$element.parent()){this.$element.appendTo(this.$parent)}else{if(!this.$parent.length){this.$element.remove();this.$element=null}}this.$element.trigger("destroyed")}};b.fn.modal=function(d,c){return this.each(function(){var g=b(this),f=g.data("modal"),e=b.extend({},b.fn.modal.defaults,g.data(),typeof d=="object"&&d);if(!f){g.data("modal",(f=new a(this,e)))}if(typeof d=="string"){f[d].apply(f,[].concat(c))}else{if(e.show){f.show()}}})};b.fn.modal.defaults={keyboard:true,backdrop:true,loading:false,show:true,width:null,height:null,maxHeight:null,modalOverflow:false,consumeTab:true,focusOn:null,replace:false,resize:false,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};b.fn.modal.Constructor=a;b(function(){b(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(h){var g=b(this),d=g.attr("href"),c=b(g.attr("data-target")||(d&&d.replace(/.*(?=#[^\s]+$)/,""))),f=c.data("modal")?"toggle":b.extend({remote:!/#/.test(d)&&d},c.data(),g.data());h.preventDefault();c.modal(f).one("hide",function(){g.focus()})})})}(window.jQuery);
/*!
 * jQuery Color Animations v2.0pre
 * http://jquery.org/
 *
 * Copyright 2011 John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(p,c){var k="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),g=/^([\-+])=\s*(\d+\.?\d*)/,f=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(q){return[q[1],q[2],q[3],q[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(q){return[2.55*q[1],2.55*q[2],2.55*q[3],q[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(q){return[parseInt(q[1],16),parseInt(q[2],16),parseInt(q[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(q){return[parseInt(q[1]+q[1],16),parseInt(q[2]+q[2],16),parseInt(q[3]+q[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(q){return[q[1],q[2]/100,q[3]/100,q[4]]}}],d=p.Color=function(r,s,q,t){return new p.Color.fn.parse(r,s,q,t)},j={rgba:{cache:"_rgba",props:{red:{idx:0,type:"byte",empty:true},green:{idx:1,type:"byte",empty:true},blue:{idx:2,type:"byte",empty:true},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:true},saturation:{idx:1,type:"percent",empty:true},lightness:{idx:2,type:"percent",empty:true}}}},o={"byte":{floor:true,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:true}},m=j.rgba.props,n=d.support={},a,l=p.each;j.hsla.props.alpha=m.alpha;function h(s,u,r){var q=o[u.type]||{},t=u.empty||r;if(t&&s==null){return null}if(u.def&&s==null){return u.def}if(q.floor){s=~~s}else{s=parseFloat(s)}if(s==null||isNaN(s)){return u.def}if(q.mod){s=s%q.mod;return s<0?q.mod+s:s}return q.min>s?q.min:q.max<s?q.max:s}function e(q){var s=d(),r=s._rgba=[];q=q.toLowerCase();l(f,function(y,z){var x=z.re.exec(q),w=x&&z.parse(x),v,u=z.space||"rgba",t=j[u].cache;if(w){v=s[u](w);s[t]=v[t];r=s._rgba=v._rgba;return false}});if(r.length!==0){if(Math.max.apply(Math,r)===0){p.extend(r,a.transparent)}return s}if(q=a[q]){return q}}d.fn=d.prototype={constructor:d,parse:function(x,v,q,w){if(x===c){this._rgba=[null,null,null,null];return this}if(x instanceof p||x.nodeType){x=x instanceof p?x.css(v):p(x).css(v);v=c}var u=this,s=p.type(x),r=this._rgba=[],t;if(v!==c){x=[x,v,q,w];s="array"}if(s==="string"){return this.parse(e(x)||a._default)}if(s==="array"){l(m,function(y,z){r[z.idx]=h(x[z.idx],z)});return this}if(s==="object"){if(x instanceof d){l(j,function(y,z){if(x[z.cache]){u[z.cache]=x[z.cache].slice()}})}else{l(j,function(y,z){l(z.props,function(B,C){var A=z.cache;if(!u[A]&&z.to){if(x[B]==null||B==="alpha"){return}u[A]=z.to(u._rgba)}u[A][C.idx]=h(x[B],C,true)})})}return this}},is:function(s){var r=d(s),t=true,q=this;l(j,function(u,w){var v=r[w.cache],x;if(v){x=q[w.cache]||w.to&&w.to(q._rgba)||[];l(w.props,function(y,z){if(v[z.idx]!=null){t=(v[z.idx]===x[z.idx]);return t}})}return t});return t},_space:function(){var q=[],r=this;l(j,function(s,t){if(r[t.cache]){q.push(s)}});return q.pop()},transition:function(r,w){var s=d(r),t=s._space(),u=j[t],v=this[u.cache]||u.to(this._rgba),q=v.slice();s=s[u.cache];l(u.props,function(A,C){var z=C.idx,y=v[z],x=s[z],B=o[C.type]||{};if(x===null){return}if(y===null){q[z]=x}else{if(B.mod){if(x-y>B.mod/2){y+=B.mod}else{if(y-x>B.mod/2){y-=B.mod}}}q[C.idx]=h((x-y)*w+y,C)}});return this[t](q)},blend:function(t){if(this._rgba[3]===1){return this}var s=this._rgba.slice(),r=s.pop(),q=d(t)._rgba;return d(p.map(s,function(u,w){return(1-r)*q[w]+r*u}))},toRgbaString:function(){var r="rgba(",q=p.map(this._rgba,function(s,t){return s==null?(t>2?1:0):s});if(q[3]===1){q.pop();r="rgb("}return r+q.join(",")+")"},toHslaString:function(){var r="hsla(",q=p.map(this.hsla(),function(s,t){if(s==null){s=t>2?1:0}if(t&&t<3){s=Math.round(s*100)+"%"}return s});if(q[3]===1){q.pop();r="hsl("}return r+q.join(",")+")"},toHexString:function(q){var r=this._rgba.slice(),s=r.pop();if(q){r.push(~~(s*255))}return"#"+p.map(r,function(t,u){t=(t||0).toString(16);return t.length===1?"0"+t:t}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}};d.fn.parse.prototype=d.fn;function b(t,s,r){r=(r+1)%1;if(r*6<1){return t+(s-t)*6*r}if(r*2<1){return s}if(r*3<2){return t+(s-t)*((2/3)-r)*6}return t}j.hsla.to=function(u){if(u[0]==null||u[1]==null||u[2]==null){return[null,null,null,u[3]]}var q=u[0]/255,x=u[1]/255,y=u[2]/255,A=u[3],z=Math.max(q,x,y),v=Math.min(q,x,y),B=z-v,C=z+v,t=C*0.5,w,D;if(v===z){w=0}else{if(q===z){w=(60*(x-y)/B)+360}else{if(x===z){w=(60*(y-q)/B)+120}else{w=(60*(q-x)/B)+240}}}if(t===0||t===1){D=t}else{if(t<=0.5){D=B/C}else{D=B/(2-C)}}return[Math.round(w)%360,D,t,A==null?1:A]};j.hsla.from=function(v){if(v[0]==null||v[1]==null||v[2]==null){return[null,null,null,v[3]]}var y=v[0]/360,C=v[1],x=v[2],B=v[3],u=x<=0.5?x*(1+C):x+C-x*C,w=2*x-u,t,z,A;return[Math.round(b(w,u,y+(1/3))*255),Math.round(b(w,u,y)*255),Math.round(b(w,u,y-(1/3))*255),B]};l(j,function(r,t){var s=t.props,q=t.cache,v=t.to,u=t.from;d.fn[r]=function(A){if(v&&!this[q]){this[q]=v(this._rgba)}if(A===c){return this[q].slice()}var z=p.type(A),w=(z==="array"||z==="object")?A:arguments,y=this[q].slice(),x;l(s,function(B,D){var C=w[z==="object"?B:D.idx];if(C==null){C=y[D.idx]}y[D.idx]=h(C,D)});if(u){x=d(u(y));x[q]=y;return x}else{return d(y)}};l(s,function(w,x){if(d.fn[w]){return}d.fn[w]=function(B){var D=p.type(B),A=(w==="alpha"?(this._hsla?"hsla":"rgba"):r),z=this[A](),C=z[x.idx],y;if(D==="undefined"){return C}if(D==="function"){B=B.call(this,C);D=p.type(B)}if(B==null&&x.empty){return this}if(D==="string"){y=g.exec(B);if(y){B=C+parseFloat(y[2])*(y[1]==="+"?1:-1)}}z[x.idx]=B;return this[A](z)}})});l(k,function(q,r){p.cssHooks[r]={set:function(v,w){var t,s,u;if(p.type(w)!=="string"||(t=e(w))){w=d(t||w);if(!n.rgba&&w._rgba[3]!==1){u=r==="backgroundColor"?v.parentNode:v;do{s=p.curCSS(u,"backgroundColor")}while((s===""||s==="transparent")&&(u=u.parentNode)&&u.style);w=w.blend(s&&s!=="transparent"?s:"_default")}w=w.toRgbaString()}v.style[r]=w}};p.fx.step[r]=function(s){if(!s.colorInit){s.start=d(s.elem,r);s.end=d(s.end);s.colorInit=true}p.cssHooks[r].set(s.elem,s.start.transition(s.end,s.pos))}});p(function(){var r=document.createElement("div"),q=r.style;q.cssText="background-color:rgba(1,1,1,.5)";n.rgba=q.backgroundColor.indexOf("rgba")>-1});a=p.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(b){b.Jcrop=function(bx,bu){function aZ(c){return Math.round(c)+"px"}function aX(c){return a9.baseClass+"-"+c}function aV(){return b.fx.step.hasOwnProperty("backgroundColor")}function aT(d){var e=b(d).offset();return[e.left,e.top]}function aS(c){return[c.pageX-a7[0],c.pageY-a7[1]]}function aQ(c){typeof c!="object"&&(c={}),a9=b.extend(a9,c),b.each(["onChange","onSelect","onRelease","onDblClick"],function(e,d){typeof a9[d]!="function"&&(a9[d]=function(){})})}function aO(h,e,m){a7=aT(aw),by.setCursor(h==="move"?h:h+"-resize");if(h==="move"){return by.activateHandlers(aK(e),aE,m)}var l=bB.getFixed(),k=aI(h),j=bB.getCorner(aI(k));bB.setPressed(bB.getCorner(k)),bB.setCurrent(j),by.activateHandlers(aM(h,l),aE,m)}function aM(d,c){return function(e){if(!a9.aspectRatio){switch(d){case"e":e[1]=c.y2;break;case"w":e[1]=c.y2;break;case"n":e[0]=c.x2;break;case"s":e[0]=c.x2}}else{switch(d){case"e":e[1]=c.y+1;break;case"w":e[1]=c.y+1;break;case"n":e[0]=c.x+1;break;case"s":e[0]=c.x+1}}bB.setCurrent(e),bz.update()}}function aK(d){var c=d;return bw.watchKeys(),function(e){bB.moveOffset([e[0]-c[0],e[1]-c[1]]),c=e,bz.update()}}function aI(c){switch(c){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function aH(c){return function(d){return a9.disabled?!1:c==="move"&&!a9.allowMove?!1:(a7=aT(aw),ac=!0,aO(c,aS(d)),d.stopPropagation(),d.preventDefault(),!1)}}function aG(g,f,k){var j=g.width(),h=g.height();j>f&&f>0&&(j=f,h=f/g.width()*g.height()),h>k&&k>0&&(h=k,j=k/g.height()*g.width()),af=g.width()/j,ae=g.height()/h,g.width(j).height(h)}function aF(c){return{x:c.x*af,y:c.y*ae,x2:c.x2*af,y2:c.y2*ae,w:c.w*af,h:c.h*ae}}function aE(d){var c=bB.getFixed();c.w>a9.minSelect[0]&&c.h>a9.minSelect[1]?(bz.enableHandles(),bz.done()):bz.release(),by.setCursor(a9.allowSelect?"crosshair":"default")}function aD(d){if(a9.disabled){return !1}if(!a9.allowSelect){return !1}ac=!0,a7=aT(aw),bz.disableHandles(),by.setCursor("crosshair");var c=aS(d);return bB.setPressed(c),bz.update(),by.activateHandlers(aC,aE,d.type.substring(0,5)==="touch"),bw.watchKeys(),d.stopPropagation(),d.preventDefault(),!1}function aC(c){bB.setCurrent(c),bz.update()}function aB(){var c=b("<div></div>").addClass(aX("tracker"));return a3&&c.css({opacity:0,backgroundColor:"white"}),c}function bv(c){at.removeClass().addClass(aX("holder")).addClass(c)}function bt(N,M){function v(){window.setTimeout(d,D)}var L=N[0]/af,K=N[1]/ae,J=N[2]/af,I=N[3]/ae;if(ab){return}var H=bB.flipCoords(L,K,J,I),G=bB.getFixed(),F=[G.x,G.y,G.x2,G.y2],E=F,D=a9.animationDelay,C=H[0]-F[0],B=H[1]-F[1],A=H[2]-F[2],z=H[3]-F[3],y=0,x=a9.swingSpeed;L=E[0],K=E[1],J=E[2],I=E[3],bz.animMode(!0);var w,d=function(){return function(){y+=(100-y)/x,E[0]=Math.round(L+y/100*C),E[1]=Math.round(K+y/100*B),E[2]=Math.round(J+y/100*A),E[3]=Math.round(I+y/100*z),y>=99.8&&(y=100),y<100?(a6(E),v()):(bz.done(),bz.animMode(!1),typeof M=="function"&&M.call(aJ))}}();v()}function a8(c){a6([c[0]/af,c[1]/ae,c[2]/af,c[3]/ae]),a9.onSelect.call(aJ,aF(bB.getFixed())),bz.enableHandles()}function a6(c){bB.setPressed([c[0],c[1]]),bB.setCurrent([c[2],c[3]]),bz.update()}function a4(){return aF(bB.getFixed())}function a2(){return bB.getFixed()}function a0(c){aQ(c),aL()}function aY(){a9.disabled=!0,bz.disableHandles(),bz.setCursor("default"),by.setCursor("default")}function aW(){a9.disabled=!1,aL()}function aU(){bz.done(),by.activateHandlers(null,null)}function aR(){at.remove(),az.show(),az.css("visibility","visible"),b(bx).removeData("Jcrop")}function aP(e,d){bz.release(),aY();var f=new Image;f.onload=function(){var l=f.width,k=f.height,j=a9.boxWidth,c=a9.boxHeight;aw.width(l).height(k),aw.attr("src",e),ar.attr("src",e),aG(aw,j,c),av=aw.width(),au=aw.height(),ar.width(av).height(au),am.width(av+an*2).height(au+an*2),at.width(av).height(au),bA.resize(av,au),aW(),typeof d=="function"&&d.call(aJ)},f.src=e}function aN(f,d,h){var g=d||a9.bgColor;a9.bgFade&&aV()&&a9.fadeTime&&!h?f.animate({backgroundColor:g},{queue:!1,duration:a9.fadeTime}):f.css("backgroundColor",g)}function aL(c){a9.allowResize?c?bz.enableOnly():bz.enableHandles():bz.disableHandles(),by.setCursor(a9.allowSelect?"crosshair":"default"),bz.setCursor(a9.allowMove?"move":"default"),a9.hasOwnProperty("trueSize")&&(af=a9.trueSize[0]/av,ae=a9.trueSize[1]/au),a9.hasOwnProperty("setSelect")&&(a8(a9.setSelect),bz.done(),delete a9.setSelect),bA.refresh(),a9.bgColor!=al&&(aN(a9.shade?bA.getShades():at,a9.shade?a9.shadeColor||a9.bgColor:a9.bgColor),al=a9.bgColor),ak!=a9.bgOpacity&&(ak=a9.bgOpacity,a9.shade?bA.refresh():bz.setBgOpacity(ak)),aj=a9.maxSize[0]||0,ai=a9.maxSize[1]||0,ah=a9.minSize[0]||0,ag=a9.minSize[1]||0,a9.hasOwnProperty("outerImage")&&(aw.attr("src",a9.outerImage),delete a9.outerImage),bz.refresh()}var a9=b.extend({},b.Jcrop.defaults),a7,a5=navigator.userAgent.toLowerCase(),a3=/msie/.test(a5),a1=/msie [1-6]\./.test(a5);typeof bx!="object"&&(bx=b(bx)[0]),typeof bu!="object"&&(bu={}),aQ(bu);var aA={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},az=b(bx),ay=!0;if(bx.tagName=="IMG"){if(az[0].width!=0&&az[0].height!=0){az.width(az[0].width),az.height(az[0].height)}else{var ax=new Image;ax.src=az[0].src,az.width(ax.width),az.height(ax.height)}var aw=az.clone().removeAttr("id").css(aA).show();aw.width(az.width()),aw.height(az.height()),az.after(aw).hide()}else{aw=az.css(aA).show(),ay=!1,a9.shade===null&&(a9.shade=!0)}aG(aw,a9.boxWidth,a9.boxHeight);var av=aw.width(),au=aw.height(),at=b("<div />").width(av).height(au).addClass(aX("holder")).css({position:"relative",backgroundColor:a9.bgColor}).insertAfter(az).append(aw);a9.addClass&&at.addClass(a9.addClass);var ar=b("<div />"),aq=b("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),ap=b("<div />").width("100%").height("100%").css("zIndex",320),ao=b("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=bB.getFixed();a9.onDblClick.call(aJ,c)}).insertBefore(aw).append(aq,ap);ay&&(ar=b("<img />").attr("src",aw.attr("src")).css(aA).width(av).height(au),aq.append(ar)),a1&&ao.css({overflowY:"hidden"});var an=a9.boundary,am=aB().width(av+an*2).height(au+an*2).css({position:"absolute",top:aZ(-an),left:aZ(-an),zIndex:290}).mousedown(aD),al=a9.bgColor,ak=a9.bgOpacity,aj,ai,ah,ag,af,ae,ad=!0,ac,ab,aa;a7=aT(aw);var a=function(){function d(){var j={},h=["touchstart","touchmove","touchend"],o=document.createElement("div"),n;try{for(n=0;n<h.length;n++){var m=h[n];m="on"+m;var l=m in o;l||(o.setAttribute(m,"return;"),l=typeof o[m]=="function"),j[h[n]]=l}return j.touchstart&&j.touchend&&j.touchmove}catch(k){return !1}}function c(){return a9.touchSupport===!0||a9.touchSupport===!1?a9.touchSupport:d()}return{createDragger:function(e){return function(f){return a9.disabled?!1:e==="move"&&!a9.allowMove?!1:(a7=aT(aw),ac=!0,aO(e,aS(a.cfilter(f)),!0),f.stopPropagation(),f.preventDefault(),!1)}},newSelection:function(e){return aD(a.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:d,support:c()}}(),bB=function(){function z(c){c=t(c),D=F=c[0],C=E=c[1]}function y(c){c=t(c),B=c[0]-D,A=c[1]-C,D=c[0],C=c[1]}function x(){return[B,A]}function w(h){var e=h[0],c=h[1];0>F+e&&(e-=e+F),0>E+c&&(c-=c+E),au<C+c&&(c+=au-(C+c)),av<D+e&&(e+=av-(D+e)),F+=e,D+=e,E+=c,C+=c}function v(e){var c=u();switch(e){case"ne":return[c.x2,c.y];case"nw":return[c.x,c.y];case"se":return[c.x2,c.y2];case"sw":return[c.x,c.y2]}}function u(){if(!a9.aspectRatio){return r()}var K=a9.aspectRatio,J=a9.minSize[0]/af,I=a9.maxSize[0]/af,H=a9.maxSize[1]/ae,G=D-F,q=C-E,p=Math.abs(G),o=Math.abs(q),e=p/o,c,N,M,L;return I===0&&(I=av*10),H===0&&(H=au*10),e<K?(N=C,M=o*K,c=G<0?F-M:M+F,c<0?(c=0,L=Math.abs((c-F)/K),N=q<0?E-L:L+E):c>av&&(c=av,L=Math.abs((c-F)/K),N=q<0?E-L:L+E)):(c=D,L=p/K,N=q<0?E-L:E+L,N<0?(N=0,M=Math.abs((N-E)*K),c=G<0?F-M:M+F):N>au&&(N=au,M=Math.abs(N-E)*K,c=G<0?F-M:M+F)),c>F?(c-F<J?c=F+J:c-F>I&&(c=F+I),N>E?N=E+(c-F)/K:N=E-(c-F)/K):c<F&&(F-c<J?c=F-J:F-c>I&&(c=F-I),N>E?N=E+(F-c)/K:N=E-(F-c)/K),c<0?(F-=c,c=0):c>av&&(F-=c-av,c=av),N<0?(E-=N,N=0):N>au&&(E-=N-au,N=au),d(s(F,E,c,N))}function t(c){return c[0]<0&&(c[0]=0),c[1]<0&&(c[1]=0),c[0]>av&&(c[0]=av),c[1]>au&&(c[1]=au),[Math.round(c[0]),Math.round(c[1])]}function s(k,j,q,p){var o=k,n=q,m=j,l=p;return q<k&&(o=q,n=k),p<j&&(m=p,l=j),[o,m,n,l]}function r(){var h=D-F,e=C-E,c;return aj&&Math.abs(h)>aj&&(D=h>0?F+aj:F-aj),ai&&Math.abs(e)>ai&&(C=e>0?E+ai:E-ai),ag/ae&&Math.abs(e)<ag/ae&&(C=e>0?E+ag/ae:E-ag/ae),ah/af&&Math.abs(h)<ah/af&&(D=h>0?F+ah/af:F-ah/af),F<0&&(D-=F,F-=F),E<0&&(C-=E,E-=E),D<0&&(F-=D,D-=D),C<0&&(E-=C,C-=C),D>av&&(c=D-av,F-=c,D-=c),C>au&&(c=C-au,E-=c,C-=c),F>av&&(c=F-au,C-=c,E-=c),E>au&&(c=E-au,C-=c,E-=c),d(s(F,E,D,C))}function d(c){return{x:c[0],y:c[1],x2:c[2],y2:c[3],w:c[2]-c[0],h:c[3]-c[1]}}var F=0,E=0,D=0,C=0,B,A;return{flipCoords:s,setPressed:z,setCurrent:y,getOffset:x,moveOffset:w,getCorner:v,getFixed:u}}(),bA=function(){function y(e,c){z.left.css({height:aZ(c)}),z.right.css({height:aZ(c)})}function x(){return w(bB.getFixed())}function w(c){z.top.css({left:aZ(c.x),width:aZ(c.w),height:aZ(c.y)}),z.bottom.css({top:aZ(c.y2),left:aZ(c.x),width:aZ(c.w),height:aZ(au-c.y2)}),z.right.css({left:aZ(c.x2),width:aZ(av-c.x2)}),z.left.css({width:aZ(c.x)})}function v(){return b("<div />").css({position:"absolute",backgroundColor:a9.shadeColor||a9.bgColor}).appendTo(A)}function u(){B||(B=!0,A.insertBefore(aw),x(),bz.setBgOpacity(1,0,1),ar.hide(),t(a9.shadeColor||a9.bgColor,1),bz.isAwake()?r(a9.bgOpacity,1):r(1,1))}function t(e,c){aN(d(),e,c)}function s(){B&&(A.remove(),ar.show(),B=!1,bz.isAwake()?bz.setBgOpacity(a9.bgOpacity,1,1):(bz.setBgOpacity(1,1,1),bz.disableHandles()),aN(at,0,1))}function r(c,f){B&&(a9.bgFade&&!f?A.animate({opacity:1-c},{queue:!1,duration:a9.fadeTime}):A.css({opacity:1-c}))}function q(){a9.shade?u():s(),bz.isAwake()&&r(a9.bgOpacity)}function d(){return A.children()}var B=!1,A=b("<div />").css({position:"absolute",zIndex:240,opacity:0}),z={top:v(),left:v().height(au),right:v().height(au),bottom:v()};return{update:x,updateRaw:w,getShades:d,setBgColor:t,enable:u,disable:s,resize:y,refresh:q,opacity:r}}(),bz=function(){function X(e){var f=b("<div />").css({position:"absolute",opacity:a9.borderOpacity}).addClass(aX(e));return aq.append(f),f}function W(e,g){var f=b("<div />").mousedown(aH(e)).css({cursor:e+"-resize",position:"absolute",zIndex:g}).addClass("ord-"+e);return a.support&&f.bind("touchstart.jcrop",a.createDragger(e)),ap.append(f),f}function V(f){var c=a9.handleSize,g=W(f,bc++).css({opacity:a9.handleOpacity}).addClass(aX("handle"));return c&&g.width(c).height(c),g}function U(c){return W(c,bc++).addClass("jcrop-dragbar")}function T(e){var c;for(c=0;c<e.length;c++){Z[e[c]]=U(e[c])}}function S(f){var e,g;for(g=0;g<f.length;g++){switch(f[g]){case"n":e="hline";break;case"s":e="hline bottom";break;case"e":e="vline right";break;case"w":e="vline"}bb[f[g]]=X(e)}}function Q(e){var c;for(c=0;c<e.length;c++){ba[e[c]]=V(e[c])}}function O(e,c){a9.shade||ar.css({top:aZ(-c),left:aZ(-e)}),ao.css({top:aZ(c),left:aZ(e)})}function K(e,c){ao.width(Math.round(e)).height(Math.round(c))}function H(){var c=bB.getFixed();bB.setPressed([c.x,c.y]),bB.setCurrent([c.x2,c.y2]),y()}function y(c){if(bd){return u(c)}}function u(e){var f=bB.getFixed();K(f.w,f.h),O(f.x,f.y),a9.shade&&bA.updateRaw(f),bd||R(),e?a9.onSelect.call(aJ,aF(f)):a9.onChange.call(aJ,aF(f))}function s(f,h,g){if(!bd&&!h){return}a9.bgFade&&!g?aw.animate({opacity:f},{queue:!1,duration:a9.fadeTime}):aw.css("opacity",f)}function R(){ao.show(),a9.shade?bA.opacity(ak):s(ak,!0),bd=!0}function P(){I(),ao.hide(),a9.shade?bA.opacity(1):s(1),bd=!1,a9.onRelease.call(aJ)}function N(){Y&&ap.show()}function J(){Y=!0;if(a9.allowResize){return ap.show(),!0}}function I(){Y=!1,ap.hide()}function D(c){c?(ab=!0,I()):(ab=!1,J())}function j(){D(!1),H()}var bd,bc=370,bb={},ba={},Z={},Y=!1;a9.dragEdges&&b.isArray(a9.createDragbars)&&T(a9.createDragbars),b.isArray(a9.createHandles)&&Q(a9.createHandles),a9.drawBorders&&b.isArray(a9.createBorders)&&S(a9.createBorders),b(document).bind("touchstart.jcrop-ios",function(c){b(c.currentTarget).hasClass("jcrop-tracker")&&c.stopPropagation()});var d=aB().mousedown(aH("move")).css({cursor:"move",position:"absolute",zIndex:360});return a.support&&d.bind("touchstart.jcrop",a.createDragger("move")),aq.append(d),I(),{updateVisible:y,update:u,release:P,refresh:H,isAwake:function(){return bd},setCursor:function(c){d.css("cursor",c)},enableHandles:J,enableOnly:function(){Y=!0},showHandles:N,disableHandles:I,animMode:D,setBgOpacity:s,done:j}}(),by=function(){function t(c){am.css({zIndex:450}),c?b(document).bind("touchmove.jcrop",o).bind("touchend.jcrop",m):u&&b(document).bind("mousemove.jcrop",r).bind("mouseup.jcrop",q)}function s(){am.css({zIndex:290}),b(document).unbind(".jcrop")}function r(c){return w(aS(c)),!1}function q(c){return c.preventDefault(),c.stopPropagation(),ac&&(ac=!1,v(aS(c)),bz.isAwake()&&a9.onSelect.call(aJ,aF(bB.getFixed())),s(),w=function(){},v=function(){}),!1}function p(c,g,f){return ac=!0,w=c,v=g,t(f),!1}function o(c){return w(aS(a.cfilter(c))),!1}function m(c){return q(a.cfilter(c))}function d(c){am.css("cursor",c)}var w=function(){},v=function(){},u=a9.trackDocument;return u||am.mousemove(r).mouseup(q).mouseout(q),aw.before(am),{activateHandlers:p,setCursor:d}}(),bw=function(){function l(){a9.keySupport&&(d.show(),d.focus())}function k(c){d.hide()}function j(f,e,g){a9.allowMove&&(bB.moveOffset([e,g]),bz.updateVisible(!0)),f.preventDefault(),f.stopPropagation()}function h(e){if(e.ctrlKey||e.metaKey){return !0}aa=e.shiftKey?!0:!1;var c=aa?10:1;switch(e.keyCode){case 37:j(e,-c,0);break;case 39:j(e,c,0);break;case 38:j(e,0,-c);break;case 40:j(e,0,c);break;case 27:a9.allowSelect&&bz.release();break;case 9:return !0}return !1}var d=b('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),m=b("<div />").css({position:"absolute",overflow:"hidden"}).append(d);return a9.keySupport&&(d.keydown(h).blur(k),a1||!a9.fixedSupport?(d.css({position:"absolute",left:"-20px"}),m.append(d).insertBefore(aw)):d.insertBefore(aw)),{watchKeys:l}}();a.support&&am.bind("touchstart.jcrop",a.newSelection),ap.hide(),aL(!0);var aJ={setImage:aP,animateTo:bt,setSelect:a8,setOptions:a0,tellSelect:a4,tellScaled:a2,setClass:bv,disable:aY,enable:aW,cancel:aU,release:bz.release,destroy:aR,focus:bw.watchKeys,getBounds:function(){return[av*af,au*ae]},getWidgetSize:function(){return[av,au]},getScaleFactor:function(){return[af,ae]},getOptions:function(){return a9},ui:{holder:at,selection:ao}};return a3&&at.bind("selectstart",function(){return !1}),az.data("Jcrop",aJ),aJ},b.fn.Jcrop=function(a,f){var e;return this.each(function(){if(b(this).data("Jcrop")){if(a==="api"){return b(this).data("Jcrop")}b(this).data("Jcrop").setOptions(a)}else{this.tagName=="IMG"?b.Jcrop.Loader(this,function(){b(this).css({display:"block",visibility:"hidden"}),e=b.Jcrop(this,a),b.isFunction(f)&&f.call(e)}):(b(this).css({display:"block",visibility:"hidden"}),e=b.Jcrop(this,a),b.isFunction(f)&&f.call(e))}}),this},b.Jcrop.Loader=function(a,m,l){function h(){j.complete?(k.unbind(".jcloader"),b.isFunction(m)&&m.call(j)):window.setTimeout(h,50)}var k=b(a),j=k[0];k.bind("load.jcloader",h).bind("error.jcloader",function(c){k.unbind(".jcloader"),b.isFunction(l)&&l.call(j)}),j.complete&&b.isFunction(m)&&(k.unbind(".jcloader"),m.call(j))},b.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:0.6,bgFade:!1,borderOpacity:0.4,handleOpacity:0.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);var FormImageCrop=function(){var j=function(){$("#demo1").Jcrop()};var g=function(){var k;$("#demo2").Jcrop({onChange:m,onSelect:m,onRelease:l},function(){k=this});$("#coords").on("change","input",function(r){var o=$("#x1").val(),n=$("#x2").val(),q=$("#y1").val(),p=$("#y2").val();k.setSelect([o,q,n,p])});function m(n){$("#x1").val(n.x);$("#y1").val(n.y);$("#x2").val(n.x2);$("#y2").val(n.y2);$("#w").val(n.w);$("#h").val(n.h)}function l(){$("#coords input").val("")}};var f=function(){var s,q,p,m=$("#preview-pane"),r=$("#preview-pane .preview-container"),l=$("#preview-pane .preview-container img"),o=r.width(),n=r.height();console.log("init",[o,n]);$("#demo3").Jcrop({onChange:k,onSelect:k,aspectRatio:o/n},function(){var t=this.getBounds();q=t[0];p=t[1];s=this;m.appendTo(s.ui.holder)});function k(v){if(parseInt(v.w)>0){var u=o/v.w;var t=n/v.h;l.css({width:Math.round(u*q)+"px",height:Math.round(t*p)+"px",marginLeft:"-"+Math.round(u*v.x)+"px",marginTop:"-"+Math.round(t*v.y)+"px"})}}};var e=function(){var t;$("#demo4").Jcrop({bgFade:true,bgOpacity:0.2,setSelect:[60,70,540,330]},function(){t=this});$("#fadetog").change(function(){t.setOptions({bgFade:this.checked})}).attr("checked",true);Metronic.updateUniform("#fadetog");$("#shadetog").change(function(){if(this.checked){$("#shadetxt").slideDown()}else{$("#shadetxt").slideUp()}t.setOptions({shade:this.checked})}).attr("checked",false);var r={bgc_buttons:"Change bgColor",bgo_buttons:"Change bgOpacity",anim_buttons:"Animate Selection"};var s={anim1:[217,122,382,284],anim2:[20,20,580,380],anim3:[24,24,176,376],anim4:[347,165,550,355],anim5:[136,55,472,183]};var o={Low:0.2,Mid:0.5,High:0.8,Full:1};var l={R:"#900",B:"#4BB6F0",Y:"#F0B207",G:"#46B81C",W:"white",K:"black"};for(i in r){m(i,r[i])}function p(v){var u=$("<button />").addClass("btn small");if(v){u.append(v)}return u}var n=1;for(i in s){$("#anim_buttons .btn-group").append(p(n++).click(k(s[i]))," ")}$("#anim_buttons .btn-group").append(p("Bye!").click(function(u){$(u.target).addClass("active");t.animateTo([300,200,300,200],function(){this.release();$(u.target).closest(".btn-group").find(".active").removeClass("active")});return false}));for(i in o){$("#bgo_buttons .btn-group").append(p(i).click(q("bgOpacity",o[i]))," ")}for(i in l){$("#bgc_buttons .btn-group").append(p(i).css({background:l[i],color:((i=="K")||(i=="R"))?"white":"black"}).click(q("bgColor",l[i]))," ")}function m(w,u){$("#interface").prepend($("<fieldset></fieldset>").attr("id",w).append($("<h4></h4>").append(u),'<div class="btn-toolbar"><div class="btn-group"></div></div>'))}function q(w,u){return function(x){$(x.target).closest(".btn-group").find(".active").removeClass("active");$(x.target).addClass("active");var v={};v[w]=u;t.setOptions(v);return false}}function k(u){return function(v){$(v.target).addClass("active");t.animateTo(u,function(){$(v.target).closest(".btn-group").find(".active").removeClass("active")});return false}}$("#bgo_buttons .btn:first,#bgc_buttons .btn:last").addClass("active");$("#interface").show()};var d=function(){var k;l();function l(){$(".requiresjcrop").hide();$("#demo5").Jcrop({onRelease:n},function(){k=this;k.animateTo([100,100,400,300]);$("#can_click,#can_move,#can_size").attr("checked","checked");Metronic.updateUniform("#can_click,#can_move,#can_size");$("#ar_lock,#size_lock,#bg_swap").attr("checked",false);Metronic.updateUniform("#ar_lock,#size_lock,#bg_swap");$(".requiresjcrop").show()})}function m(){var o=k.getBounds();return[Math.round(Math.random()*o[0]),Math.round(Math.random()*o[1]),Math.round(Math.random()*o[0]),Math.round(Math.random()*o[1])]}function n(){k.setOptions({allowSelect:true});$("#can_click").attr("checked",false);Metronic.updateUniform("#can_click")}$("#setSelect").click(function(o){k.setSelect(m())});$("#animateTo").click(function(o){k.animateTo(m())});$("#release").click(function(o){k.release()});$("#disable").click(function(o){k.disable();$("#enable").show();$(".requiresjcrop").hide()});$("#enable").click(function(o){k.enable();$("#enable").hide();$(".requiresjcrop").show()});$("#rehook").click(function(o){$("#rehook,#enable").hide();l();$("#unhook,.requiresjcrop").show();return false});$("#unhook").click(function(o){k.destroy();$("#unhook,#enable,.requiresjcrop").hide();$("#rehook").show();return false});$("#img1").click(function(o){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");k.setImage("../../assets/global/plugins/jcrop/demos/demo_files/sago.jpg");k.setOptions({bgOpacity:0.6});return false});$("#img2").click(function(o){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");k.setImage("../../assets/global/plugins/jcrop/demos/demo_files/pool.jpg");k.setOptions({bgOpacity:0.6});return false});$("#img3").click(function(o){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");k.setImage("../../assets/global/plugins/jcrop/demos/demo_files/sago.jpg",function(){this.setOptions({bgOpacity:1,outerImage:"../../assets/global/plugins/jcrop/demos/demo_files/sagomod.jpg"});this.animateTo(m())});return false});$("#can_click").change(function(o){k.setOptions({allowSelect:!!this.checked});k.focus()});$("#can_move").change(function(o){k.setOptions({allowMove:!!this.checked});k.focus()});$("#can_size").change(function(o){k.setOptions({allowResize:!!this.checked});k.focus()});$("#ar_lock").change(function(o){k.setOptions(this.checked?{aspectRatio:4/3}:{aspectRatio:0});k.focus()});$("#size_lock").change(function(o){k.setOptions(this.checked?{minSize:[80,80],maxSize:[350,350]}:{minSize:[0,0],maxSize:[0,0]});k.focus()})};var c=function(){var k;$("#demo6").Jcrop({bgOpacity:0.5,bgColor:"white",addClass:"jcrop-light"},function(){k=this;k.setSelect([130,65,130+350,65+285]);k.setOptions({bgFade:true});k.ui.selection.addClass("jcrop-selection")});$("#buttonbar").on("click","button",function(m){var n=$(this),l=n.closest(".btn-group");l.find("button.active").removeClass("active");n.addClass("active");l.find("[data-setclass]").each(function(){var p=$(this),q=p.data("setclass"),o=p.hasClass("active");if(o){k.ui.holder.addClass(q);switch(q){case"jcrop-light":k.setOptions({bgColor:"white",bgOpacity:0.5});break;case"jcrop-dark":k.setOptions({bgColor:"black",bgOpacity:0.4});break;case"jcrop-normal":k.setOptions({bgColor:$.Jcrop.defaults.bgColor,bgOpacity:$.Jcrop.defaults.bgOpacity});break}}else{k.ui.holder.removeClass(q)}})})};var b=function(){var k={x:13,y:7,x2:487,y2:107,w:474,h:100};$("#demo7").Jcrop({bgFade:true,setSelect:[k.x,k.y,k.x2,k.y2]})};var a=function(){$("#demo8").Jcrop({aspectRatio:1,onSelect:k});function k(l){$("#crop_x").val(l.x);$("#crop_y").val(l.y);$("#crop_w").val(l.w);$("#crop_h").val(l.h)}$("#demo8_form").submit(function(){if(parseInt($("#crop_w").val())){return true}alert("Please select a crop region then press submit.");return false})};var h=function(){if($(window).width()<=1024&&$(window).width()>=678){$(".responsive-1024").each(function(){$(this).attr("data-class",$(this).attr("class"));$(this).attr("class","responsive-1024 col-md-12")})}else{$(".responsive-1024").each(function(){if($(this).attr("data-class")){$(this).attr("class",$(this).attr("data-class"));$(this).removeAttr("data-class")}})}};return{init:function(){if(!jQuery().Jcrop){return}Metronic.addResizeHandler(h);h();j();g();f();e();d();c();b();a()}}}();
/*!
 * jQuery UI Widget 1.10.4+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(b,e){var a=0,d=Array.prototype.slice,c=b.cleanData;b.cleanData=function(f){for(var g=0,h;(h=f[g])!=null;g++){try{b(h).triggerHandler("remove")}catch(j){}}c(f)};b.widget=function(f,g,o){var l,m,j,n,h={},k=f.split(".")[0];f=f.split(".")[1];l=k+"-"+f;if(!o){o=g;g=b.Widget}b.expr[":"][l.toLowerCase()]=function(p){return !!b.data(p,l)};b[k]=b[k]||{};m=b[k][f];j=b[k][f]=function(p,q){if(!this._createWidget){return new j(p,q)}if(arguments.length){this._createWidget(p,q)}};b.extend(j,m,{version:o.version,_proto:b.extend({},o),_childConstructors:[]});n=new g();n.options=b.widget.extend({},n.options);b.each(o,function(q,p){if(!b.isFunction(p)){h[q]=p;return}h[q]=(function(){var r=function(){return g.prototype[q].apply(this,arguments)},s=function(t){return g.prototype[q].apply(this,t)};return function(){var v=this._super,t=this._superApply,u;this._super=r;this._superApply=s;u=p.apply(this,arguments);this._super=v;this._superApply=t;return u}})()});j.prototype=b.widget.extend(n,{widgetEventPrefix:m?(n.widgetEventPrefix||f):f},h,{constructor:j,namespace:k,widgetName:f,widgetFullName:l});if(m){b.each(m._childConstructors,function(q,r){var p=r.prototype;b.widget(p.namespace+"."+p.widgetName,j,r._proto)});delete m._childConstructors}else{g._childConstructors.push(j)}b.widget.bridge(f,j)};b.widget.extend=function(l){var g=d.call(arguments,1),k=0,f=g.length,h,j;for(;k<f;k++){for(h in g[k]){j=g[k][h];if(g[k].hasOwnProperty(h)&&j!==e){if(b.isPlainObject(j)){l[h]=b.isPlainObject(l[h])?b.widget.extend({},l[h],j):b.widget.extend({},j)}else{l[h]=j}}}}return l};b.widget.bridge=function(g,f){var h=f.prototype.widgetFullName||g;b.fn[g]=function(l){var j=typeof l==="string",k=d.call(arguments,1),m=this;l=!j&&k.length?b.widget.extend.apply(null,[l].concat(k)):l;if(j){this.each(function(){var o,n=b.data(this,h);if(!n){return b.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+l+"'")}if(!b.isFunction(n[l])||l.charAt(0)==="_"){return b.error("no such method '"+l+"' for "+g+" widget instance")}o=n[l].apply(n,k);if(o!==n&&o!==e){m=o&&o.jquery?m.pushStack(o.get()):o;return false}})}else{this.each(function(){var n=b.data(this,h);if(n){n.option(l||{})._init()}else{b.data(this,h,new f(l,this))}})}return m}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(f,g){g=b(g||this.defaultElement||this)[0];this.element=b(g);this.uuid=a++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=b.widget.extend({},this.options,this._getCreateOptions(),f);this.bindings=b();this.hoverable=b();this.focusable=b();if(g!==this){b.data(g,this.widgetFullName,this);this._on(true,this.element,{remove:function(h){if(h.target===g){this.destroy()}}});this.document=b(g.style?g.ownerDocument:g.document||g);this.window=b(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(j,k){var f=j,l,h,g;if(arguments.length===0){return b.widget.extend({},this.options)}if(typeof j==="string"){f={};l=j.split(".");j=l.shift();if(l.length){h=f[j]=b.widget.extend({},this.options[j]);for(g=0;g<l.length-1;g++){h[l[g]]=h[l[g]]||{};h=h[l[g]]}j=l.pop();if(arguments.length===1){return h[j]===e?null:h[j]}h[j]=k}else{if(arguments.length===1){return this.options[j]===e?null:this.options[j]}f[j]=k}}this._setOptions(f);return this},_setOptions:function(f){var g;for(g in f){this._setOption(g,f[g])}return this},_setOption:function(f,g){this.options[f]=g;if(f==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!g).attr("aria-disabled",g);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(j,h,g){var k,f=this;if(typeof j!=="boolean"){g=h;h=j;j=false}if(!g){g=h;h=this.element;k=this.widget()}else{h=k=b(h);this.bindings=this.bindings.add(h)}b.each(g,function(q,p){function n(){if(!j&&(f.options.disabled===true||b(this).hasClass("ui-state-disabled"))){return}return(typeof p==="string"?f[p]:p).apply(f,arguments)}if(typeof p!=="string"){n.guid=p.guid=p.guid||n.guid||b.guid++}var o=q.match(/^(\w+)\s*(.*)$/),m=o[1]+f.eventNamespace,l=o[2];if(l){k.delegate(l,m,n)}else{h.bind(m,n)}})},_off:function(g,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;g.unbind(f).undelegate(f)},_delay:function(j,h){function g(){return(typeof j==="string"?f[j]:j).apply(f,arguments)}var f=this;return setTimeout(g,h||0)},_hoverable:function(f){this.hoverable=this.hoverable.add(f);this._on(f,{mouseenter:function(g){b(g.currentTarget).addClass("ui-state-hover")},mouseleave:function(g){b(g.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(f){this.focusable=this.focusable.add(f);this._on(f,{focusin:function(g){b(g.currentTarget).addClass("ui-state-focus")},focusout:function(g){b(g.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(f,g,h){var l,k,j=this.options[f];h=h||{};g=b.Event(g);g.type=(f===this.widgetEventPrefix?f:this.widgetEventPrefix+f).toLowerCase();g.target=this.element[0];k=g.originalEvent;if(k){for(l in k){if(!(l in g)){g[l]=k[l]}}}this.element.trigger(g,h);return !(b.isFunction(j)&&j.apply(this.element[0],[g].concat(h))===false||g.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(g,f){b.Widget.prototype["_"+g]=function(k,j,m){if(typeof j==="string"){j={effect:j}}var l,h=!j?g:j===true||typeof j==="number"?f:j.effect||f;j=j||{};if(typeof j==="number"){j={duration:j}}l=!b.isEmptyObject(j);j.complete=m;if(j.delay){k.delay(j.delay)}if(l&&b.effects&&b.effects.effect[h]){k[g](j)}else{if(h!==g&&k[h]){k[h](j.duration,j.easing,m)}else{k.queue(function(n){b(this)[g]();if(m){m.call(k[0])}n()})}}}})}));(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(b){var a=0;b.ajaxTransport("iframe",function(d){if(d.async){var c=d.initialIframeSrc||"javascript:false;",f,e,g;return{send:function(h,j){f=b('<form style="display:none;"></form>');f.attr("accept-charset",d.formAcceptCharset);g=/\?/.test(d.url)?"&":"?";if(d.type==="DELETE"){d.url=d.url+g+"_method=DELETE";d.type="POST"}else{if(d.type==="PUT"){d.url=d.url+g+"_method=PUT";d.type="POST"}else{if(d.type==="PATCH"){d.url=d.url+g+"_method=PATCH";d.type="POST"}}}a+=1;e=b('<iframe src="'+c+'" name="iframe-transport-'+a+'"></iframe>').bind("load",function(){var k,l=b.isArray(d.paramName)?d.paramName:[d.paramName];e.unbind("load").bind("load",function(){var m;try{m=e.contents();if(!m.length||!m[0].firstChild){throw new Error()}}catch(n){m=undefined}j(200,"success",{iframe:m});b('<iframe src="'+c+'"></iframe>').appendTo(f);window.setTimeout(function(){f.remove()},0)});f.prop("target",e.prop("name")).prop("action",d.url).prop("method",d.type);if(d.formData){b.each(d.formData,function(m,n){b('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(f)})}if(d.fileInput&&d.fileInput.length&&d.type==="POST"){k=d.fileInput.clone();d.fileInput.after(function(m){return k[m]});if(d.paramName){d.fileInput.each(function(m){b(this).prop("name",l[m]||d.paramName)})}f.append(d.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data");d.fileInput.removeAttr("form")}f.submit();if(k&&k.length){d.fileInput.each(function(n,m){var o=b(k[n]);b(m).prop("name",o.prop("name")).attr("form",o.attr("form"));o.replaceWith(m)})}});f.append(e).appendTo(document.body)},abort:function(){if(e){e.unbind("load").prop("src",c)}if(f){f.remove()}}}}});b.ajaxSetup({converters:{"iframe text":function(c){return c&&b(c[0].body).text()},"iframe json":function(c){return c&&b.parseJSON(b(c[0].body).text())},"iframe html":function(c){return c&&b(c[0].body).html()},"iframe xml":function(c){var d=c&&c[0];return d&&b.isXMLDoc(d)?d:b.parseXML((d.XMLDocument&&d.XMLDocument.xml)||b(d.body).html())},"iframe script":function(c){return c&&b.globalEval(b(c[0].body).text())}}})}));(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],a)}else{a(window.jQuery)}}(function(a){a.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||a('<input type="file">').prop("disabled"));a.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);a.support.xhrFormDataFileUpload=!!window.FormData;a.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.widget("blueimp.fileupload",{options:{dropZone:a(document),pasteZone:a(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(c,b){c=this.messages[c]||c.toString();if(b){a.each(b,function(d,e){c=c.replace("{"+d+"}",e)})}return c},formData:function(b){return b.serializeArray()},add:function(c,b){if(c.isDefaultPrevented()){return false}if(b.autoUpload||(b.autoUpload!==false&&a(this).fileupload("option","autoUpload"))){b.process().done(function(){b.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:a.support.blobSlice&&function(){var b=this.slice||this.webkitSlice||this.mozSlice;return b.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(d,c,b){var e=d-this.timestamp;if(!this.bitrate||!b||e>b){this.bitrate=(c-this.loaded)*(1000/e)*8;this.loaded=c;this.timestamp=d}return this.bitrate}},_isXHRUpload:function(b){return !b.forceIframeTransport&&((!b.multipart&&a.support.xhrFileUpload)||a.support.xhrFormDataFileUpload)},_getFormData:function(b){var c;if(a.type(b.formData)==="function"){return b.formData(b.form)}if(a.isArray(b.formData)){return b.formData}if(a.type(b.formData)==="object"){c=[];a.each(b.formData,function(d,e){c.push({name:d,value:e})});return c}return[]},_getTotal:function(c){var b=0;a.each(c,function(d,e){b+=e.size||1});return b},_initProgressObject:function(c){var b={loaded:0,total:0,bitrate:0};if(c._progress){a.extend(c._progress,b)}else{c._progress=b}},_initResponseObject:function(b){var c;if(b._response){for(c in b._response){if(b._response.hasOwnProperty(c)){delete b._response[c]}}}else{b._response={}}},_onProgress:function(f,d){if(f.lengthComputable){var c=((Date.now)?Date.now():(new Date()).getTime()),b;if(d._time&&d.progressInterval&&(c-d._time<d.progressInterval)&&f.loaded!==f.total){return}d._time=c;b=Math.floor(f.loaded/f.total*(d.chunkSize||d._progress.total))+(d.uploadedBytes||0);this._progress.loaded+=(b-d._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(c,this._progress.loaded,d.bitrateInterval);d._progress.loaded=d.loaded=b;d._progress.bitrate=d.bitrate=d._bitrateTimer.getBitrate(c,b,d.bitrateInterval);this._trigger("progress",a.Event("progress",{delegatedEvent:f}),d);this._trigger("progressall",a.Event("progressall",{delegatedEvent:f}),this._progress)}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();if(d.upload){a(d.upload).bind("progress",function(f){var g=f.originalEvent;f.lengthComputable=g.lengthComputable;f.loaded=g.loaded;f.total=g.total;c._onProgress(f,b)});b.xhr=function(){return d}}},_isInstanceOf:function(b,c){return Object.prototype.toString.call(c)==="[object "+b+"]"},_initXHRData:function(c){var e=this,g,d=c.files[0],b=c.multipart||!a.support.xhrFileUpload,f=a.type(c.paramName)==="array"?c.paramName[0]:c.paramName;c.headers=a.extend({},c.headers);if(c.contentRange){c.headers["Content-Range"]=c.contentRange}if(!b||c.blob||!this._isInstanceOf("File",d)){c.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"'}if(!b){c.contentType=d.type||"application/octet-stream";c.data=c.blob||d}else{if(a.support.xhrFormDataFileUpload){if(c.postMessage){g=this._getFormData(c);if(c.blob){g.push({name:f,value:c.blob})}else{a.each(c.files,function(h,j){g.push({name:(a.type(c.paramName)==="array"&&c.paramName[h])||f,value:j})})}}else{if(e._isInstanceOf("FormData",c.formData)){g=c.formData}else{g=new FormData();a.each(this._getFormData(c),function(h,j){g.append(j.name,j.value)})}if(c.blob){g.append(f,c.blob,d.name)}else{a.each(c.files,function(h,j){if(e._isInstanceOf("File",j)||e._isInstanceOf("Blob",j)){g.append((a.type(c.paramName)==="array"&&c.paramName[h])||f,j,j.uploadName||j.name)}})}}c.data=g}}c.blob=null},_initIframeSettings:function(b){var c=a("<a></a>").prop("href",b.url).prop("host");b.dataType="iframe "+(b.dataType||"");b.formData=this._getFormData(b);if(b.redirect&&c&&c!==location.host){b.formData.push({name:b.redirectParamName||"redirect",value:b.redirect})}},_initDataSettings:function(b){if(this._isXHRUpload(b)){if(!this._chunkedUpload(b,true)){if(!b.data){this._initXHRData(b)}this._initProgressListener(b)}if(b.postMessage){b.dataType="postmessage "+(b.dataType||"")}}else{this._initIframeSettings(b)}},_getParamName:function(b){var c=a(b.fileInput),d=b.paramName;if(!d){d=[];c.each(function(){var e=a(this),f=e.prop("name")||"files[]",g=(e.prop("files")||[1]).length;while(g){d.push(f);g-=1}});if(!d.length){d=[c.prop("name")||"files[]"]}}else{if(!a.isArray(d)){d=[d]}}return d},_initFormSettings:function(b){if(!b.form||!b.form.length){b.form=a(b.fileInput.prop("form"));if(!b.form.length){b.form=a(this.options.fileInput.prop("form"))}}b.paramName=this._getParamName(b);if(!b.url){b.url=b.form.prop("action")||location.href}b.type=(b.type||(a.type(b.form.prop("method"))==="string"&&b.form.prop("method"))||"").toUpperCase();if(b.type!=="POST"&&b.type!=="PUT"&&b.type!=="PATCH"){b.type="POST"}if(!b.formAcceptCharset){b.formAcceptCharset=b.form.attr("accept-charset")}},_getAJAXSettings:function(c){var b=a.extend({},this.options,c);this._initFormSettings(b);this._initDataSettings(b);return b},_getDeferredState:function(b){if(b.state){return b.state()}if(b.isResolved()){return"resolved"}if(b.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(b){b.success=b.done;b.error=b.fail;b.complete=b.always;return b},_getXHRPromise:function(e,d,c){var b=a.Deferred(),f=b.promise();d=d||this.options.context||f;if(e===true){b.resolveWith(d,c)}else{if(e===false){b.rejectWith(d,c)}}f.abort=b.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(f,d){var c=this,b=function(e){return a.Deferred().resolveWith(c,e).promise()};d.process=function(g,e){if(g||e){d._processQueue=this._processQueue=(this._processQueue||b([this])).pipe(function(){if(d.errorThrown){return a.Deferred().rejectWith(c,[d]).promise()}return b(arguments)}).pipe(g,e)}return this._processQueue||b([this])};d.submit=function(){if(this.state()!=="pending"){d.jqXHR=this.jqXHR=(c._trigger("submit",a.Event("submit",{delegatedEvent:f}),this)!==false)&&c._onSend(f,this)}return this.jqXHR||c._getXHRPromise()};d.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";c._trigger("fail",null,this);return c._getXHRPromise(false)};d.state=function(){if(this.jqXHR){return c._getDeferredState(this.jqXHR)}if(this._processQueue){return c._getDeferredState(this._processQueue)}};d.processing=function(){return !this.jqXHR&&this._processQueue&&c._getDeferredState(this._processQueue)==="pending"};d.progress=function(){return this._progress};d.response=function(){return this._response}},_getUploadedBytes:function(d){var b=d.getResponseHeader("Range"),e=b&&b.split("-"),c=e&&e.length>1&&parseInt(e[1],10);return c&&c+1},_chunkedUpload:function(n,g){n.uploadedBytes=n.uploadedBytes||0;var f=this,d=n.files[0],e=d.size,b=n.uploadedBytes,c=n.maxChunkSize||e,j=this._blobSlice,k=a.Deferred(),m=k.promise(),h,l;if(!(this._isXHRUpload(n)&&j&&(b||c<e))||n.data){return false}if(g){return true}if(b>=e){d.error=n.i18n("uploadedBytes");return this._getXHRPromise(false,n.context,[null,"error",d.error])}l=function(){var q=a.extend({},n),p=q._progress.loaded;q.blob=j.call(d,b,b+c,d.type);q.chunkSize=q.blob.size;q.contentRange="bytes "+b+"-"+(b+q.chunkSize-1)+"/"+e;f._initXHRData(q);f._initProgressListener(q);h=((f._trigger("chunksend",null,q)!==false&&a.ajax(q))||f._getXHRPromise(false,q.context)).done(function(o,s,r){b=f._getUploadedBytes(r)||(b+q.chunkSize);if(p+q.chunkSize-q._progress.loaded){f._onProgress(a.Event("progress",{lengthComputable:true,loaded:b-q.uploadedBytes,total:b-q.uploadedBytes}),q)}n.uploadedBytes=q.uploadedBytes=b;q.result=o;q.textStatus=s;q.jqXHR=r;f._trigger("chunkdone",null,q);f._trigger("chunkalways",null,q);if(b<e){l()}else{k.resolveWith(q.context,[o,s,r])}}).fail(function(o,s,r){q.jqXHR=o;q.textStatus=s;q.errorThrown=r;f._trigger("chunkfail",null,q);f._trigger("chunkalways",null,q);k.rejectWith(q.context,[o,s,r])})};this._enhancePromise(m);m.abort=function(){return h.abort()};l();return m},_beforeSend:function(c,b){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(b,g,f,d){var e=d._progress.total,c=d._response;if(d._progress.loaded<e){this._onProgress(a.Event("progress",{lengthComputable:true,loaded:e,total:e}),d)}c.result=d.result=b;c.textStatus=d.textStatus=g;c.jqXHR=d.jqXHR=f;this._trigger("done",null,d)},_onFail:function(d,f,e,c){var b=c._response;if(c.recalculateProgress){this._progress.loaded-=c._progress.loaded;this._progress.total-=c._progress.total}b.jqXHR=c.jqXHR=d;b.textStatus=c.textStatus=f;b.errorThrown=c.errorThrown=e;this._trigger("fail",null,c)},_onAlways:function(d,e,c,b){this._trigger("always",null,b)},_onSend:function(h,f){if(!f.submit){this._addConvenienceMethods(h,f)}var g=this,k,b,j,c,l=g._getAJAXSettings(f),d=function(){g._sending+=1;l._bitrateTimer=new g._BitrateTimer();k=k||(((b||g._trigger("send",a.Event("send",{delegatedEvent:h}),l)===false)&&g._getXHRPromise(false,l.context,b))||g._chunkedUpload(l)||a.ajax(l)).done(function(e,n,m){g._onDone(e,n,m,l)}).fail(function(e,n,m){g._onFail(e,n,m,l)}).always(function(n,o,m){g._onAlways(n,o,m,l);g._sending-=1;g._active-=1;if(l.limitConcurrentUploads&&l.limitConcurrentUploads>g._sending){var e=g._slots.shift();while(e){if(g._getDeferredState(e)==="pending"){e.resolve();break}e=g._slots.shift()}}if(g._active===0){g._trigger("stop")}});return k};this._beforeSend(h,l);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){j=a.Deferred();this._slots.push(j);c=j.pipe(d)}else{this._sequence=this._sequence.pipe(d,d);c=this._sequence}c.abort=function(){b=[undefined,"abort","abort"];if(!k){if(j){j.rejectWith(l.context,b)}return d()}return k.abort()};return this._enhancePromise(c)}return d()},_onAdd:function(p,l){var o=this,u=true,t=a.extend({},this.options,l),d=l.files,r=d.length,f=t.limitMultiFileUploads,h=t.limitMultiFileUploadSize,s=t.limitMultiFileUploadSizeOverhead,n=0,m=this._getParamName(t),c,b,q,k,g=0;if(h&&(!r||d[0].size===undefined)){h=undefined}if(!(t.singleFileUploads||f||h)||!this._isXHRUpload(t)){q=[d];c=[m]}else{if(!(t.singleFileUploads||h)&&f){q=[];c=[];for(k=0;k<r;k+=f){q.push(d.slice(k,k+f));b=m.slice(k,k+f);if(!b.length){b=m}c.push(b)}}else{if(!t.singleFileUploads&&h){q=[];c=[];for(k=0;k<r;k=k+1){n+=d[k].size+s;if(k+1===r||((n+d[k+1].size+s)>h)||(f&&k+1-g>=f)){q.push(d.slice(g,k+1));b=m.slice(g,k+1);if(!b.length){b=m}c.push(b);g=k+1;n=0}}}else{c=m}}}l.originalFiles=d;a.each(q||d,function(e,j){var v=a.extend({},l);v.files=q?j:[j];v.paramName=c[e];o._initResponseObject(v);o._initProgressObject(v);o._addConvenienceMethods(p,v);u=o._trigger("add",a.Event("add",{delegatedEvent:p}),v);return u});return u},_replaceFileInput:function(b){var c=b.clone(true);a("<form></form>").append(c)[0].reset();b.after(c).detach();a.cleanData(b.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(d,e){if(e===b[0]){return c[0]}return e});if(b[0]===this.element[0]){this.element=c}},_handleFileTreeEntry:function(f,g){var e=this,b=a.Deferred(),c=function(h){if(h&&!h.entry){h.entry=f}b.resolve([h])},d;g=g||"";if(f.isFile){if(f._file){f._file.relativePath=g;b.resolve(f._file)}else{f.file(function(h){h.relativePath=g;b.resolve(h)},c)}}else{if(f.isDirectory){d=f.createReader();d.readEntries(function(h){e._handleFileTreeEntries(h,g+f.name+"/").done(function(j){b.resolve(j)}).fail(c)},c)}else{b.resolve([])}}return b.promise()},_handleFileTreeEntries:function(b,d){var c=this;return a.when.apply(a,a.map(b,function(e){return c._handleFileTreeEntry(e,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(c){c=c||{};var b=c.items;if(b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)){return this._handleFileTreeEntries(a.map(b,function(e){var d;if(e.webkitGetAsEntry){d=e.webkitGetAsEntry();if(d){d._file=e.getAsFile()}return d}return e.getAsEntry()}))}return a.Deferred().resolve(a.makeArray(c.files)).promise()},_getSingleFileInputFiles:function(d){d=a(d);var b=d.prop("webkitEntries")||d.prop("entries"),c,e;if(b&&b.length){return this._handleFileTreeEntries(b)}c=a.makeArray(d.prop("files"));if(!c.length){e=d.prop("value");if(!e){return a.Deferred().resolve([]).promise()}c=[{name:e.replace(/^.*\\/,"")}]}else{if(c[0].name===undefined&&c[0].fileName){a.each(c,function(f,g){g.name=g.fileName;g.size=g.fileSize})}}return a.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){if(!(b instanceof a)||b.length===1){return this._getSingleFileInputFiles(b)}return a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(d){var b=this,c={fileInput:a(d.target),form:a(d.target.form)};this._getFileInputFiles(c.fileInput).always(function(e){c.files=e;if(b.options.replaceFileInput){b._replaceFileInput(c.fileInput)}if(b._trigger("change",a.Event("change",{delegatedEvent:d}),c)!==false){b._onAdd(d,c)}})},_onPaste:function(d){var b=d.originalEvent&&d.originalEvent.clipboardData&&d.originalEvent.clipboardData.items,c={files:[]};if(b&&b.length){a.each(b,function(e,g){var f=g.getAsFile&&g.getAsFile();if(f){c.files.push(f)}});if(this._trigger("paste",a.Event("paste",{delegatedEvent:d}),c)!==false){this._onAdd(d,c)}}},_onDrop:function(f){f.dataTransfer=f.originalEvent&&f.originalEvent.dataTransfer;var b=this,d=f.dataTransfer,c={};if(d&&d.files&&d.files.length){f.preventDefault();this._getDroppedFiles(d).always(function(e){c.files=e;if(b._trigger("drop",a.Event("drop",{delegatedEvent:f}),c)!==false){b._onAdd(f,c)}})}},_onDragOver:function(c){c.dataTransfer=c.originalEvent&&c.originalEvent.dataTransfer;var b=c.dataTransfer;if(b&&a.inArray("Files",b.types)!==-1&&this._trigger("dragover",a.Event("dragover",{delegatedEvent:c}))!==false){c.preventDefault();b.dropEffect="copy"}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if(a.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(b,c){var d=a.inArray(b,this._specialOptions)!==-1;if(d){this._destroyEventHandlers()}this._super(b,c);if(d){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var b=this.options;if(b.fileInput===undefined){b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else{if(!(b.fileInput instanceof a)){b.fileInput=a(b.fileInput)}}if(!(b.dropZone instanceof a)){b.dropZone=a(b.dropZone)}if(!(b.pasteZone instanceof a)){b.pasteZone=a(b.pasteZone)}},_getRegExp:function(d){var c=d.split("/"),b=c.pop();c.shift();return new RegExp(c.join("/"),b)},_isRegExpOption:function(b,c){return b!=="url"&&a.type(c)==="string"&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var c=this,b=this.options,d=a(this.element[0].cloneNode(false));a.each(d.data(),function(e,f){var g="data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(d.attr(g)){if(c._isRegExpOption(e,f)){f=c._getRegExp(f)}b[e]=f}})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(c){var b=this;if(!c||this.options.disabled){return}if(c.fileInput&&!c.files){this._getFileInputFiles(c.fileInput).always(function(d){c.files=d;b._onAdd(null,c)})}else{c.files=a.makeArray(c.files);this._onAdd(null,c)}},send:function(f){if(f&&!this.options.disabled){if(f.fileInput&&!f.files){var d=this,b=a.Deferred(),g=b.promise(),c,e;g.abort=function(){e=true;if(c){return c.abort()}b.reject(null,"abort","abort");return g};this._getFileInputFiles(f.fileInput).always(function(h){if(e){return}if(!h.length){b.reject();return}f.files=h;c=d._onSend(null,f).then(function(j,l,k){b.resolve(j,l,k)},function(j,l,k){b.reject(j,l,k)})});return this._enhancePromise(g)}f.files=a.makeArray(f.files);if(f.files.length){return this._onSend(null,f)}}return this._getXHRPromise(false,f&&f.context)}})}));